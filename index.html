<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Colorful Custom Hand AI Project (fcAI)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link rel="stylesheet" href="style.css" />

<!-- TensorFlow / COCO -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-converter"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgl"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>
</head>

<body>

<header id="topHeader">
  <div id="titleArea">
    <h1>Colorful Custom Hand AI Project</h1>
    <div id="languageLabel">Display language: English</div>
  </div>
</header>

<div id="appContainer">

  <div id="videoWrapper" style="position:relative; max-width:420px; margin:auto;">

    <video id="video" autoplay playsinline
      style="width:100%; border-radius:10px; background:#000;"></video>

    <!-- ðŸ”µ Bounding Box Canvas -->
    <canvas id="bboxCanvas"
      style="position:absolute; inset:0; pointer-events:none;"></canvas>

    <!-- ðŸ– Hand SVG -->
    <svg id="overlaySvg" viewBox="0 0 220 220"
      style="position:absolute; inset:0; pointer-events:none;">

      <!-- RELAXED -->
      <g id="handRelaxed" class="hand-svg active">
        <rect x="80" y="90" width="60" height="70" rx="20" ry="20" class="palm-line"/>
        <line x1="100" y1="160" x2="100" y2="188" class="wrist-line"/>
        <line x1="120" y1="160" x2="120" y2="188" class="wrist-line"/>
        <circle cx="110" cy="160" r="4" fill="#ccc"/>
        <!-- fingers -->
        <line x1="96" y1="90" x2="96" y2="65" class="finger"/>
        <line x1="110" y1="88" x2="110" y2="60" class="finger"/>
        <line x1="124" y1="90" x2="124" y2="66" class="finger"/>
        <!-- thumb -->
        <line x1="86" y1="115" x2="68" y2="128" class="finger"/>
      </g>

      <!-- PEN -->
      <g id="handPen" class="hand-svg">
        <rect x="80" y="90" width="60" height="70" rx="20" ry="20" class="palm-line"/>
        <line x1="100" y1="160" x2="100" y2="188" class="wrist-line"/>
        <line x1="120" y1="160" x2="120" y2="188" class="wrist-line"/>
        <circle cx="110" cy="160" r="4" fill="#ccc"/>
        <!-- fingers -->
        <line x1="100" y1="100" x2="102" y2="70" class="finger"/>
        <line x1="116" y1="100" x2="114" y2="70" class="finger"/>
        <line x1="90" y1="120" x2="98" y2="90" class="finger"/>
        <line x1="130" y1="120" x2="138" y2="92" class="finger"/>
        <!-- thumb -->
        <line x1="86" y1="120" x2="68" y2="135" class="finger"/>
        <!-- pen -->
        <line x1="100" y1="80" x2="120" y2="120" class="pen-body"/>
      </g>

      <!-- PHONEï¼ˆæŒ‡ä¿®æ­£æ¸ˆãƒ»5æœ¬ï¼‰ -->
      <g id="handPhone" class="hand-svg">
        <rect x="92" y="60" width="50" height="90" rx="8" ry="8" class="phone-body"/>
        <rect x="80" y="95" width="60" height="65" rx="20" ry="20" class="palm-line"/>
        <line x1="100" y1="160" x2="100" y2="188" class="wrist-line"/>
        <line x1="120" y1="160" x2="120" y2="188" class="wrist-line"/>
        <circle cx="110" cy="160" r="4" fill="#ccc"/>
        <!-- fingers -->
        <line x1="92" y1="130" x2="92" y2="110" class="finger"/>
        <line x1="102" y1="128" x2="102" y2="105" class="finger"/>
        <line x1="112" y1="128" x2="112" y2="105" class="finger"/>
        <line x1="122" y1="128" x2="122" y2="105" class="finger"/>
        <!-- thumb -->
        <line x1="86" y1="135" x2="68" y2="150" class="finger"/>
      </g>

      <!-- KEYï¼ˆè§¦ã£ã¦ã„ãªã„ï¼‰ -->
      <g id="handKey" class="hand-svg">
        <rect x="80" y="95" width="60" height="65" rx="20" ry="20" class="palm-line"/>
        <line x1="100" y1="160" x2="100" y2="188" class="wrist-line"/>
        <line x1="120" y1="160" x2="120" y2="188" class="wrist-line"/>
        <circle cx="110" cy="160" r="4" fill="#ccc"/>
        <line x1="108" y1="100" x2="132" y2="102" class="finger"/>
        <line x1="110" y1="108" x2="135" y2="112" class="finger"/>
        <!-- thumb -->
        <line x1="88" y1="118" x2="68" y2="130" class="finger"/>
        <rect x="60" y="112" width="26" height="4" class="key-body"/>
        <rect x="86" y="105" width="20" height="18" rx="9" ry="9" class="key-body"/>
      </g>

    </svg>
  </div>

  <div id="resultArea">
    <div id="result">State: RELAXED</div>
    <div id="status">Ready.</div>
  </div>

  <div id="controlPanel">
    <button id="startCameraBtn">Start Camera</button>
  </div>

</div>

<script src="app.js"></script>

<script>
/* ===== bbox æç”»ã ã‘ index.html å´ã§ä¿è¨¼ ===== */
const video = document.getElementById("video");
const canvas = document.getElementById("bboxCanvas");
const ctx = canvas.getContext("2d");

function syncCanvas() {
  canvas.width  = video.videoWidth;
  canvas.height = video.videoHeight;
}

video.addEventListener("loadedmetadata", syncCanvas);
window.addEventListener("resize", syncCanvas);

/* app.js ãŒ window.latestDetections ã‚’æ›´æ–°ã™ã‚‹å‰æ */
function drawBoxes() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if (window.latestDetections) {
    window.latestDetections.forEach(d=>{
      const [x,y,w,h] = d.bbox;
      ctx.lineWidth = 3;
      ctx.strokeStyle =
        d.class === "cell phone" ? "#00f" :
        d.class === "pen"        ? "#0f0" :
        d.class === "key"        ? "#0cf" : "#fff";
      ctx.strokeRect(x,y,w,h);
      ctx.fillStyle = ctx.strokeStyle;
      ctx.font = "16px sans-serif";
      ctx.fillText(d.class, x+4, y+18);
    });
  }
  requestAnimationFrame(drawBoxes);
}
drawBoxes();
</script>

</body>
</html>
